package com.pjzhong.leetcode;

import java.util.HashMap;
import java.util.Map;
import org.junit.Test;

/**
 * Given two arrays of integers nums1 and nums2, return the number of triplets formed (type 1 and
 * type 2) under the following rules:
 *
 * Type 1: Triplet (i, j, k) if nums1[i]2 == nums2[j] * nums2[k] where 0 <= i < nums1.length and 0
 * <= j < k < nums2.length. Type 2: Triplet (i, j, k) if nums2[i]2 == nums1[j] * nums1[k] where 0 <=
 * i < nums2.length and 0 <= j < k < nums1.length.
 *
 * @link https://leetcode.com/contest/weekly-contest-205/problems/number-of-ways-where-square-of-number-is-equal-to-product-of-two-numbers/
 **/
public class NumberofWaysWhereSquareofNumberIsEqualtoProductofTwoNumbers {


  @Test
  public void test() {
    int[][] tests =
        {

            {43024, 99908},
            {1864},

            {7, 4},
            {5, 2, 8, 9},

            {1, 1},
            {1, 1, 1},

            {65700, 88886, 8401, 23123, 84498, 49304, 70555, 33231, 45614, 60781, 81267, 51966,
                58070, 89734, 67513, 89311, 59589, 42907, 57236, 21299, 83801, 38047, 48584, 72260,
                93293, 47277, 46804, 85073, 24183, 22002, 32259, 6312, 30856, 17046, 53480, 51757,
                53374, 59575, 49983, 19005, 49160, 11393, 71644, 59227, 10910, 39361, 7630, 80628,
                80258, 4777, 80853, 915, 8636, 30172, 17398, 22510, 13247, 99641, 83372, 98986,
                35555, 56413, 64739, 69242, 41733, 14202, 3129, 29617, 88606, 1833, 36690, 49130,
                51483, 88083, 66183, 99045, 22213, 40859, 3927, 33393, 35132, 10182, 9924, 60685,
                38853, 21077, 34234, 93965, 44169, 59618, 57960, 41765, 89263, 66970, 15293, 61813,
                23775, 74123, 34663, 28494, 89300, 72015, 47485, 14720, 93690, 16532, 77118, 13201,
                1471, 50301, 33745, 56356, 21301, 81216, 68469, 10833, 75830, 28890, 67947, 40845,
                97623, 7106, 72012, 42242, 84687, 76659, 40042, 68942, 49218, 20356, 3475, 85932,
                67947, 54204, 21767, 81382, 34198, 31151, 43102, 20313, 85098, 3539, 15313, 44721,
                51444, 92529, 27520, 81727, 62045, 73826, 41228, 55950, 39063, 61488, 19948, 52735,
                13564, 74981, 18946, 78811, 28089, 94496, 82971, 12167, 22489, 57482, 704, 10288,
                79974, 47701, 2817, 97837, 89137, 69159, 64692, 27156, 1754, 94977, 48094, 59578,
                56871, 63022, 87058, 97341, 5617, 37342, 278, 79048, 39491, 66098, 30326, 71974,
                34143, 12448, 19481, 80721, 53281, 41376, 66994, 21554, 31401, 21152, 24937, 79752,
                71952, 87826, 69436, 84791, 16278, 38888, 85507, 8727, 21630, 62036, 42189, 15201,
                35113, 29410, 28821, 11375, 17913, 80735, 49839, 59374, 34583, 6154, 88977, 58287,
                2708, 25936, 67911, 81487, 5630, 17278, 13011, 4475, 56122, 82197, 76394, 98965,
                90413, 76895, 391, 34119, 71312, 57742, 66642, 82382, 13023, 44584, 52926, 66831,
                45939, 63748, 65413, 82129, 28456, 91011, 14290, 58049, 36134, 8335, 26541, 43936,
                28652, 27170, 40890, 54460, 55951, 52465, 52667, 93140, 88137, 53987, 74358, 38961,
                44332, 93916, 36933, 33285, 16535, 91597, 35493, 46475, 92849, 6793, 2188, 43305,
                20394, 85248, 12543, 77466, 70241, 70557, 51340, 46117, 48000, 36948, 5012, 88090,
                84391, 38289, 38145, 36332, 57701, 68926, 52353, 15551, 82366, 78249, 53208, 11907,
                86806, 26817, 7792, 47468, 95400, 61608, 76250, 92594, 93077, 66811, 25870, 65905,
                57591, 19412, 41723, 2728, 71857, 93491, 92874, 59639, 94038, 81513, 90104, 43992,
                72652, 18930, 85379, 45324, 53088, 15652, 71833, 67485, 81024, 13832, 38188, 8389,
                23673, 488, 49913, 46340, 79365, 17330, 77873, 24257, 47525, 59142, 40269, 84121,
                39058, 37999, 38960, 10734, 86074, 52618, 22298, 35593, 92550, 86681, 32362, 43679,
                87900, 58943, 62967, 463, 41533, 67461, 29478, 49723, 40596, 31177, 56367, 26086,
                35686, 44923, 9514, 10846, 96007, 13093, 51538, 42930, 13760, 2944, 1928, 49618,
                35985, 59877, 68506, 13213, 20939, 31891, 46693, 58181, 69934, 13457, 49435, 3234,
                42528, 89908, 51486, 65317, 89860, 11425, 1400, 95881, 44799, 13778, 72202, 17613,
                45321, 24720, 17678, 71553, 72045, 22274, 59639, 98495, 8652, 77797, 36132, 90462,
                98217, 45063, 62970, 40565, 26523, 19551, 26208, 66673, 61541, 56381, 12803, 61940,
                25958, 24413, 88699, 79688, 63159, 83287, 70513, 55277, 65382, 58575, 26883, 51517,
                33837, 46947, 24264, 53805, 76696, 18433, 68534, 85133, 52462, 51691, 19895, 12039,
                74060, 62343, 65329, 98289, 58514, 64027, 54234, 14963, 74904, 99470, 82488, 36856,
                8485, 30344, 42419, 53993, 76166, 19787, 13346, 75192, 92905, 93689, 35641, 32126,
                18327, 80262, 19773, 84909, 22368, 95238, 77401, 26300, 56220, 75450, 90404, 79300,
                75428, 4051, 16763, 95635, 7310, 37391, 54108, 9424, 24336, 86147, 81068, 79967,
                16972, 73913, 3868, 36789, 71611, 40614, 61597, 16655, 2548, 22446, 12943, 72064,
                96380, 49160, 92702, 89906, 59386, 53485, 39149, 63917, 43635, 1380, 37666, 88809,
                94395, 20760, 58889, 89524, 15270, 41019, 55278, 77145, 39636, 30770, 43756, 31402,
                72818, 32323, 82264, 53018, 10049, 40061, 11369, 38679, 8688, 83017, 53600, 78355,
                49641, 33638, 29123, 6498, 52753, 94229, 48023, 94693, 5695, 88389, 95986, 46645,
                45886, 20913, 57204, 29497, 69898, 21424, 43293, 14362, 6350, 66947, 19285, 12595,
                81479, 91512, 24586, 10157, 52707, 80216, 54476, 46889, 6654, 71535, 4808, 60888,
                86699, 4038, 98601, 75111, 36666, 41754, 31946, 99358, 2538, 16721, 81893, 63192,
                40736, 29765, 45733, 7174, 21242, 45756, 6520, 66554, 33722, 99055, 2698, 38969,
                42858, 87516, 26255, 68589, 46845, 70869, 40661, 85795, 68774, 87425, 99812, 57656,
                75255, 20961, 20050, 72646, 73106, 67672, 29132, 64472, 33548, 92615, 88196, 6137,
                56391, 11218, 40381, 50286, 45505, 53344, 28520, 44659, 23049, 90707, 82963, 47531,
                77357, 2457, 41515, 39738, 23266, 55441, 16517, 89399, 36783, 60604, 62743, 20662,
                10356, 39303, 79996, 8742, 92722, 14023, 30582, 94360, 55916, 94876, 54564, 66230,
                80103, 70525, 84910, 58558, 23534, 388, 79387, 99863, 14524, 64293, 4688, 3428,
                91789, 37747, 97426, 37488, 21992, 41058, 42520, 17133, 31019, 99133, 96649, 46287,
                97618, 47980, 21381, 79131, 10964, 98494, 41775, 59160, 6342, 7217, 95215, 6421,
                20901, 2351, 18894, 81667, 50301, 51125, 33899, 44611, 99882, 38180, 73082, 10157,
                97485, 46798, 33248, 53558, 10176, 32295, 98784, 8819, 16697, 47796, 92566, 46436,
                58796, 770, 90630, 42788, 98786, 11577, 47231, 41703, 66739, 27952, 69045, 15402,
                79348, 64781, 32936, 19534, 83738, 91476, 41687, 42278, 7887, 29183, 46409, 17638,
                81271, 66126, 15745, 9899, 77618, 97782, 53634, 79856, 25359, 6138, 41506, 38343,
                64081, 84333, 11814, 12019, 59358, 93416, 58841, 89421, 48905, 30961, 85469, 64601,
                46945, 72739, 85109, 26312, 41935, 77011, 5310, 45176, 21022, 362, 16198, 56997,
                24069, 26050, 46375, 34899, 7499, 35703, 86146, 97471, 95427, 98691, 2653, 8754,
                86820, 44505, 50665, 85143, 70287, 12461, 47961, 39939, 56874, 52882, 96527, 83320,
                52757, 58409, 70242, 45344, 98132, 46453, 23504, 34080, 98201, 10114, 32664, 33859,
                56183, 70668, 75759, 91625, 74243, 7252, 87865, 9303, 26849, 92018, 50014, 25418,
                24909, 31072, 98154, 38563, 95582, 90444, 15368, 88914, 72284, 80869, 28562, 99153,
                45902, 67848, 62823, 12715, 45623, 26878, 84296, 99271, 66554, 85835, 38775, 67357,
                14177, 90152, 26900, 62344, 83173, 45152, 75048, 25590, 67127, 44621, 33120, 6229,
                51173, 43751, 8946, 35406, 88808, 44963, 17008, 22415, 1588, 39230, 70004, 60080,
                43232, 29872, 78819, 49481, 17041, 690, 85486, 57141, 14555, 1984, 88423, 32026,
                12557, 53562, 61735, 80085, 46317, 3212, 20291, 29822, 70640, 18050, 42983, 21145,
                45351, 52316, 35842, 53408, 55505, 17227, 60887, 6809, 5555, 34192, 34439, 11841,
                57517, 83136, 3208, 39678, 22687, 23389, 2504, 33271, 60864, 42872, 69449, 88303,
                7486, 12967, 21171, 59228, 24470, 40082, 37993, 78565, 87244, 53433, 32716, 5438,
                11117, 2509, 53975, 64166, 70941, 90314, 8457, 22104, 21467, 1094, 3341, 21132,
                3436, 49951, 46068, 79308, 14729, 93584, 19980, 63353, 89948, 35769, 78686, 8547,
                49690, 8163, 81918, 86313, 7084, 58305, 67359, 37397, 99701, 51908, 41864, 81872,
                57092, 3693, 34342, 73198,
            },
            {18783, 58778, 63861, 10297, 80153, 6718, 854, 78397, 98464, 8565, 52317, 10525, 67871,
                96308, 54835, 89872, 75034, 77220, 33785, 49946, 36363, 47039, 31419, 20687, 41171,
                12551, 2669, 68971, 5975, 50789, 7434, 8530, 82044, 96400, 96263, 89276, 73153,
                12817, 46891, 29348, 97966, 40570, 11915, 69730, 21214, 10066, 5721, 74845, 12315,
                66917, 70030, 7410, 97913, 57010, 3545, 69356, 57186, 48353, 8124, 97124, 67992,
                91480, 85903, 15931, 13619, 69478, 92214, 80217, 35966, 60514, 41495, 34231, 52078,
                12305, 98066, 38443, 66783, 66034, 97150, 97402, 70992, 14068, 33595, 25868, 47745,
                80201, 8581, 12684, 21965, 63211, 29906, 83550, 47833, 41082, 27558, 93692, 29506,
                63519, 36718, 75118, 54797, 66337, 63448, 20245, 48177, 11643, 71291, 46949, 79165,
                31105, 85820, 24143, 32806, 53900, 52440, 40413, 62622, 10408, 23044, 28010, 93629,
                32119, 22537, 18724, 93606, 56846, 86828, 12206, 74459, 40915, 13779, 16007, 59599,
                58314, 71288, 40056, 67017, 52339, 36173, 8366, 93126, 28951, 54437, 60876, 80227,
                25651, 61724, 95691, 62027, 10066, 9562, 85626, 55324, 85479, 34853, 91211, 25135,
                75769, 17934, 85259, 66062, 20416, 2146, 51447, 84770, 61377, 95852, 8047, 11343,
                31163, 49931, 45142, 79285, 78787, 75608, 68742, 80528, 6449, 94583, 87445, 64166,
                79439, 9352, 54252, 82145, 60439, 63668, 47944, 84103, 12512, 39382, 19267, 36272,
                15207, 35776, 96004, 12904, 46461, 77966, 58787, 15473, 96159, 34407, 82346, 76364,
                87901, 45675, 89959, 88336, 27971, 72752, 80847, 98892, 60517, 13354, 71101, 7596,
                16415, 32528, 91626, 45594, 73851, 12257, 38439, 27738, 59301, 50217, 64300, 28801,
                60405, 69343, 50262, 30511, 92400, 15416, 25509, 65741, 21971, 46450, 4000, 68824,
                57039, 64245, 44074, 17006, 1930, 4316, 93582, 53664, 61611, 3718, 91202, 34021,
                56393, 43367, 77386, 34548, 61650, 74241, 91272, 59750, 30909, 55542, 92618, 95323,
                89721, 95437, 19840, 50902, 49442, 54238, 93762, 43544, 26348, 53870, 40736, 60598,
                83827, 81340, 5633, 71371, 71996, 15768, 49764, 61313, 17043, 86211, 13096, 30172,
                70542, 26796, 97320, 44322, 79779, 64384, 83674, 79595, 98132, 96067, 38798, 40487,
                30958, 61801, 11498, 44288, 47269, 670, 29250, 92280, 94133, 21212, 77416, 10368,
                20063, 96677, 87013, 44945, 11115, 99122, 97233, 37622, 46226, 35028, 36022, 23413,
                22710, 92302, 55935, 13926, 64799, 38975, 64986, 67402, 8902, 12490, 61073, 50541,
                57195, 18632, 24588, 40072, 28039, 12350, 22020, 79862, 21434, 55400, 14983, 46590,
                98861, 52650, 3311, 44638, 44852, 92297, 5233, 56287, 42993, 47726, 2497, 9563,
                49735, 55022, 85412, 98664, 70706, 65574, 13507, 51451, 40375, 50888, 84522, 34931,
                85247, 75804, 59938, 83041, 9273, 28761, 84450, 42710, 19703, 96241, 12299, 65719,
                11328, 60172, 87162, 81374, 69169, 49507, 58900, 64375, 73870, 59278, 50993, 61861,
                1765, 57989, 21363, 63604, 80189, 29798, 902, 76225, 33149, 15163, 29606, 99537,
                13573, 41221, 70952, 56913, 73316, 17186, 63016, 57817, 23443, 33414, 58963, 72886,
                96018, 34991, 65422, 64314, 13253, 55787, 45012, 31236, 1585, 97361, 52795, 83008,
                69648, 68272, 33857, 86107, 44203, 95982, 14337, 94207, 91523, 23356, 65972, 6609,
                62312, 80753, 46702, 83901, 90836, 84504, 54146, 43609, 44315, 85915, 7798, 24409,
                54321, 34175, 43535, 26246, 64753, 55061, 26145, 1802, 61375, 45847, 39711, 87988,
                40560, 57766, 66072, 84937, 64583, 42483, 51922, 51975, 18506, 64618, 15596, 98521,
                53389, 72792, 96353, 97988, 97012, 67759, 62663, 10353, 83812, 38437, 22917, 94457,
                25343, 73533, 79162, 65064, 32787, 17063, 82534, 24209, 18849, 13897, 71092, 46619,
                25189, 1543, 45166, 26366, 46783, 12773, 75699, 32452, 27301, 46348, 26865, 21424,
                15296, 86194, 92704, 89203, 16104, 44313, 85771, 80835, 32707, 77296, 30022, 42531,
                59361, 43242, 81447, 49213, 56873, 83133, 31831, 46442, 4330, 13893, 35401, 79571,
                11428, 13468, 85822, 93484, 30347, 89939, 34186, 80913, 44704, 68171, 99862, 74889,
                71111, 12788, 78235, 62501, 27739, 15190, 95472, 81080, 59804, 28467, 48846, 29561,
                30876, 99081, 82884, 76357, 49093, 31058, 22986, 89852, 56294, 39316, 7734, 48900,
                35943, 87283, 52653, 85179, 52677, 58285, 79919, 63498, 7743, 66218, 99245, 86942,
                4211, 12534, 85591, 37233, 50518, 69454, 62938, 25428, 9097, 97435, 39981, 71683,
                10773, 77914, 11690, 18813, 21474, 59623, 96317, 19763, 21120, 51026, 34258, 21225,
                44798, 77574, 98462, 40546, 43419, 11107, 45425, 1337, 43215, 17245, 92645, 42336,
                82507, 82578, 40093, 81997, 48969, 20016, 44563, 33794, 11675, 75502, 85349, 23311,
                5176, 98374, 48243, 92036, 63889, 37835, 57202, 12692, 32858, 96059, 86881, 55048,
                25927, 75106, 53542, 44891, 2606, 38911, 45997, 89554, 19820, 59795, 24692, 21650,
                4924, 25596, 18911, 4754, 77383, 9483, 51210, 35964, 40360, 23535, 10949, 70206,
                72256, 7333, 9051, 12022, 6601, 30247, 62338, 23724, 43364, 72172, 12425, 58922,
                92741, 58854, 31519, 34602, 49889, 61505, 62198, 60869, 42587, 63899, 60375, 96626,
                6014, 15959, 9171, 61874, 92819, 37851, 11804, 34253, 10585, 9945, 76467, 26048,
                65462, 20254, 60384, 16063, 48958, 51355, 24840, 5034, 76315, 74166, 82559, 99821,
                45489, 41485, 87209, 55881, 3304, 26519, 12434, 16438, 62803, 77578, 23992, 68232,
                77237, 80266, 24108, 50851, 58507, 2456, 90489, 23626, 54553, 30931, 52318, 86274,
                65828, 28501, 38368, 54888, 31282, 41294, 19966, 43644, 4881, 68936, 14669, 21822,
                76820, 36536, 75043, 2185, 13481, 6406, 65440, 40273, 18935, 68282, 80671, 63992,
                72693, 64874, 51216, 12561, 37705, 95521, 24734, 70588, 43493, 75550, 37569, 58911,
                94571, 40818, 39333, 59882, 87878, 5766, 23138, 31381, 44910, 20709, 56506, 60422,
                62148, 10009, 94297, 72225, 23015, 86983, 47171, 96754, 46022, 99778, 32950, 40731,
                16812, 60673, 45750, 27646, 28580, 42988, 36048, 56007, 19503, 22190, 98518, 97948,
                46753, 67166, 8151, 17169, 35693, 61953, 57993, 79161, 73307, 40001, 21235, 44912,
                94631, 29261, 14351, 96201, 84644, 61360, 66052, 9800, 89069, 45241, 12831, 47820,
                50813, 15346, 56493, 59048, 38317, 73950, 93595, 76638, 76760, 85336, 93107, 10497,
                25208, 52584, 42405, 74431, 88102, 11501, 51811, 38603, 55168, 23815, 21329, 74108,
                84671, 27495, 19832, 93717, 93742, 22619, 23379, 14276, 43443, 29109, 32443, 73821,
                96231, 80671, 25012, 7767, 32848, 65839, 18290, 7987, 41168, 47797, 55116, 51316,
                37571, 16546, 63593, 62378, 85904, 72842, 84835, 29523, 47486, 66115, 43528, 30338,
                68316, 79730, 22879, 47374, 1508, 50857, 8270, 54496, 23461, 21644, 85217, 32376,
                43179, 10164, 79949, 27529, 46026, 36728, 46632, 7676, 13046, 76752, 35334, 59760,
                75691, 98208, 13940, 36018, 43955, 13128, 19499, 18952, 31550, 28680, 46751, 11024,
                67568, 79430, 12932, 48321, 50365, 37792, 62703, 5878, 72658, 70369, 94830, 7175,
                29489, 6099, 39587, 4480, 11581, 88879, 44553, 20184, 6154, 78076, 26293, 34464,
                80095, 24910, 31350, 54227, 90388, 45567, 1309, 96592, 95546, 34184, 52797, 34248,
                43730, 7396, 42814, 9745, 11525, 55391, 41773, 13487, 10447, 43994, 31545, 39720,
                56968, 27586, 50746, 42231, 25386, 46877, 20150, 1904, 91986, 4154, 49452, 56257,
                34554, 76291, 78480,
            },

            {4, 7, 9, 11, 23},
            {3, 5, 1024, 12, 18},
        };

    for (int i = 1; i < tests.length; i += 2) {
      System.out.println(numTriplets(tests[i - 1], tests[i]));
    }
  }

  public int numTriplets(int[] nums1, int[] nums2) {
    Map<Long, Integer> cache = new HashMap<>(nums1.length + nums2.length);

    int result = 0;
    calc(nums2, cache);
    for (long i : nums1) {
      result += cache.getOrDefault(i * i, 0);
    }

    cache.clear();
    calc(nums1, cache);
    for (long i : nums2) {
      result += cache.getOrDefault(i * i, 0);
    }

    return result;

  }

  private void calc(int[] nums1, Map<Long, Integer> cache) {
    for (int i = 0; i < nums1.length; i++) {
      long left = nums1[i];
      for (int j = i + 1; j < nums1.length; j++) {
        cache.merge(left * nums1[j], 1, Integer::sum);
      }
    }
  }

}
